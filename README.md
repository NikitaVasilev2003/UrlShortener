# Реализация VIP ссылок для приложения UrlShortener

## Описание идеи

Задача заключалась в добавлении фичи "VIP ссылки", которая позволяет пользователям создавать короткие URL с уникальными ключами по своему выбору, при условии, что выбранный ключ еще не занят. Также была реализована возможность задать срок действия для этих ссылок (TTL).

## Продуктовые гипотезы

1. Если пользователи смогут задавать собственные короткие URL, то это улучшит их опыт работы с сервисом, потому что это позволит создавать удобные и легко запоминающиеся ссылки.
2. Если сервис позволит устанавливать срок жизни для ссылок, то пользователи смогут лучше контролировать их использование, потому что это даст возможность удалять ссылки после определенного времени.

## Оценка трудозатрат на реализацию

Для выполнения задачи потребовались следующие этапы:
- Реализация логики для проверки уникальности VIP ключа.
- Добавление функционала для TTL (время жизни ссылок).
- Написание API для создания и управления VIP ссылками.

Время, необходимое для реализации:
- Проверка уникальности VIP ключа — 4-6 часов.
- Реализация TTL — 6-8 часов.
- Создание API и тестов — 8-10 часов.
- Общая оценка: 20-24 часа.

## MVP (Минимально жизнеспособный продукт)

Для быстрого тестирования идеи была реализована базовая версия функционала:
- Возможность создать VIP ссылку с заданным пользователем ключом.
- Реализация TTL (время жизни ссылки) с максимальным сроком 2 дня.
- Без дополнительных функций, таких как статистика или возможность удалять ссылки.

Оценка времени для MVP: 8-10 часов.

## Архитектура

### Диаграмма классов

```plaintext
+-----------------+      +-------------------+
|   UrlShortener  |<---->|    VipLink        |
+-----------------+      +-------------------+
| - create_vip()  |      | - vip_key         |
| - check_avail() |      | - time_to_live    |
| - create_link() |      | - created_at      |
| - get_stats()   |      | - ttl             |
+-----------------+      +-------------------+

User -> UrlShortener: make_shorter(url, vip_key, ttl)
UrlShortener -> Database: check_vip_key_availability(vip_key)
UrlShortener -> Database: store_vip_link(vip_key, ttl)
Database -> UrlShortener: return success
UrlShortener -> User: return short_url, secret_key

### 6. Реализация

```markdown
## Реализация

1. **Проверка входных данных**: добавлена проверка на корректность входных данных (например, если VIP ключ уже занят или TTL указан неверно).
2. **Логика работы**:
   - При создании VIP ссылки проверяется, не занят ли выбранный ключ.
   - Если ключ свободен, ссылка создается с указанным временем жизни.
   - Время жизни ограничено максимум 2 дня, и оно может быть задано в различных единицах: секунды, минуты, часы, дни.
3. **API**:
   - `/make_shorter`: основной endpoint для создания VIP ссылок.
   - Ответ включает короткую ссылку и секретный ключ для управления ею.

## Тестирование

Все тесты на создание VIP ссылок были успешно выполнены. Для этого использовалась команда:

```bash
make test


### 8. АБ-тест

```markdown
## АБ-тест

Для проверки эффективности новой фичи можно провести АБ-тест, разделив пользователей на две группы:
- **Группа A**: использует стандартные короткие ссылки.
- **Группа B**: использует VIP ссылки с возможностью задания собственного ключа.

Параметры эксперимента:
- Количество создаваемых ссылок.
- Количество уникальных пользователей, использующих VIP ссылки.
- Время жизни ссылки и ее использование.

## Метрики

Для оценки успешности внедрения VIP ссылок будет использоваться несколько метрик:
1. **Частота создания VIP ссылок** — сколько пользователей воспользовались возможностью задать свой ключ.
2. **Скорость использования ссылок** — количество кликов по VIP ссылкам.
3. **Удовлетворенность пользователей** — можно провести опросы среди пользователей, использующих VIP ссылки.

Ожидаемые результаты:
- Увеличение количества созданных ссылок на 20%.
- Повышение вовлеченности пользователей на 15%.

## Заключение

Фича "VIP ссылки" была успешно реализована и готова к внедрению. В дальнейшем можно улучшить функционал, добавив статистику использования ссылок и дополнительные возможности для их управления.
